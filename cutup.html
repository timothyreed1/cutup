<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cutup</title>
<style>
  body {
    font-family: "Helvetica Neue", Arial, sans-serif;
    background-color: #0e0e0e;
    color: #f0f0f0;
    padding: 2rem;
    max-width: 900px;
    margin: auto;
  }
  h1 {
    text-align: center;
    color: #ffd166;
  }
  textarea {
    width: 100%;
    height: 180px;
    padding: 1rem;
    background: #1e1e1e;
    color: #f0f0f0;
    border: 1px solid #444;
    border-radius: 6px;
    resize: vertical;
  }
  select, button, input[type="range"] {
    margin-top: 1rem;
    padding: 0.5rem;
    border-radius: 4px;
    background: #2a2a2a;
    color: #f0f0f0;
    border: 1px solid #555;
  }
  button {
    cursor: pointer;
  }
  #generateBtn {
    background-color: #118ab2;
    border: none;
  }
  #generateBtn:hover {
    background-color: #06d6a0;
  }
  label {
    display: block;
    margin-top: 1rem;
  }
  .output-container {
    margin-top: 2rem;
  }
  .output-box {
    background: #1e1e1e;
    border: 1px solid #444;
    border-radius: 6px;
    margin-top: 1rem;
    padding: 1rem;
  }
  .output-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .output-buttons {
    display: flex;
    gap: 0.5rem;
  }
  .toggle-btn {
    background: #2a2a2a;
    border: 1px solid #555;
    color: #f0f0f0;
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    cursor: pointer;
  }
  .toggle-btn:hover {
    background: #06d6a0;
    color: #000;
  }
  .output-text {
    margin-top: 0.75rem;
    white-space: pre-wrap;
  }
  .collapsed .output-text {
    display: none;
  }
</style>
</head>
<body>

<h1>Cutup</h1>

<textarea id="inputText" placeholder="Paste text here"></textarea>

<label for="chunkType">Chunk Type:</label>
<select id="chunkType">
  <option value="sentence">Sentence</option>
  <option value="phrase">Phrase</option>
  <option value="word">Word</option>
</select>

<label for="numChunks">Number of Fragments: <span id="chunkCountLabel">All</span></label>
<input type="range" id="numChunks" min="1" max="100" value="100">

<button id="generateBtn">Generate Cut-Up</button>

<div id="outputs" class="output-container"></div>

<script>
function cutUp(text, chunkType, numChunks) {
  let chunks;
  if (chunkType === "word") {
    chunks = text.match(/\b\w+\b/g);
  } else if (chunkType === "phrase") {
    chunks = text.split(/,|;|\sand\s|\sbut\s/gi);
  } else {
    chunks = text.split(/(?<=[.!?])\s+/);
  }

  chunks = chunks.filter(Boolean).map(c => c.trim());
  shuffle(chunks);

  if (numChunks && numChunks < chunks.length) {
    chunks = chunks.slice(0, numChunks);
  }

  return chunks.join(" ");
}

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

function collapseAll() {
  document.querySelectorAll(".output-box").forEach(box => {
    box.classList.add("collapsed");
  });
}

function createOutputBox(text, index) {
  const container = document.createElement("div");
  container.classList.add("output-box");
  
  const header = document.createElement("div");
  header.classList.add("output-header");
  const title = document.createElement("span");
  title.textContent = `Cut-Up #${index}`;
  
  const buttons = document.createElement("div");
  buttons.classList.add("output-buttons");

  const expandBtn = document.createElement("button");
  expandBtn.textContent = "+";
  expandBtn.classList.add("toggle-btn");
  expandBtn.addEventListener("click", () => {
    container.classList.remove("collapsed");
  });

  const collapseBtn = document.createElement("button");
  collapseBtn.textContent = "âˆ’";
  collapseBtn.classList.add("toggle-btn");
  collapseBtn.addEventListener("click", () => {
    container.classList.add("collapsed");
  });

  buttons.appendChild(expandBtn);
  buttons.appendChild(collapseBtn);
  header.appendChild(title);
  header.appendChild(buttons);
  container.appendChild(header);

  const content = document.createElement("div");
  content.classList.add("output-text");
  content.textContent = text;
  container.appendChild(content);

  return container;
}

document.getElementById("generateBtn").addEventListener("click", () => {
  const text = document.getElementById("inputText").value.trim();
  if (!text) return;
  const type = document.getElementById("chunkType").value;
  const num = parseInt(document.getElementById("numChunks").value);

  const cutupText = cutUp(text, type, num);

  const outputs = document.getElementById("outputs");
  collapseAll();

  const newBox = createOutputBox(cutupText, outputs.children.length + 1);
  outputs.prepend(newBox);
});

const slider = document.getElementById("numChunks");
const label = document.getElementById("chunkCountLabel");
slider.addEventListener("input", () => {
  label.textContent = slider.value;
});
</script>

</body>
</html>
